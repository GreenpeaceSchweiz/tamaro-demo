<!DOCTYPE html>

<html>

<head>
	<meta charset="UTF-8">

	<style>

		:root {
			--tamaro-primary-color: #333333;
			--tamaro-primary-color__hover: #777777;
			--tamaro-primary-bg-color: #f2f2fb;
		}

		.rnw-widget-container {
			width: 100%;
			max-width: 37.5rem;
			margin: 0 auto;
		}

		#tamaro-widget.tamaro-widget {
			padding: 2rem;
			box-shadow: 0 0 0.25rem 0 rgba(0, 0, 0, 0.1);
		}

		#tamaro-widget.tamaro-widget .error-widget,
		body.tamaro-widget-overlay-inner.tamaro-widget-overlay-shown #tamaro-widget.tamaro-widget .overlay-block-wrapper {
			margin: -2rem;
		}

		#tamaro-widget.tamaro-widget .gpch_product {
			margin-bottom: 24px;
		}

		#tamaro-widget.tamaro-widget .widget-block.next-step-block {
			margin-top: 3.2rem;
		}

		#tamaro-widget.tamaro-widget .next-step .main button{
			font-size: 1.125rem;
			min-height: 4rem;
		}
	</style>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
	<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js?ver=3.3.1"></script> -->

</head>

<body>

<div class="rnw-widget-container"></div>

<script src="https://tamaro.raisenow.com/greenpeace-demo/latest/widget.js"></script>

<script>
	window.rnw.tamaro.runWidget('.rnw-widget-container', {
		debug: false,
		testMode: false,
		language: 'de',
		showStoredCustomerEmailPermission: true,
		showStoredCustomerDonationReceipt: false,
		paymentFormPrefill: {
			stored_customer_email_permission: true,
			stored_customer_donation_receipt: true,
			stored_sf_Contact_Source__c: 'Internet',
			gpch_product: 'Standard Donation',
			stored_sf_Opportunity_Product__c: '',
			stored_sf_npe03__Recurring_Donation__c_Product__c: ''
		},
		paymentWidgetBlocks: [
			// 'payment_purposes',
			'payment_amounts_and_intervals',
			// 'payment_payment_methods',
			// 'payment_profile',
			// 'payment_address',
			// 'payment_cover_fee'
		],
		purposes: ['p1'],
		purposeDetails: {
			p1: {
				stored_campaign_id: '7013O000000hqhwQAA'
			}
		},
		slots: {
			purposes_start: [{
				component: "field",
				type: "select",
				name: "gpch_product",
				label: "payment_form.gpch_product",
				options: [
					{value: 'Standard Donation', label: 'payment_form.gpch_products.standard_donation'},
					{value: 'Sponsorship Agriculture', label: 'payment_form.gpch_products.sponsorship_agriculture'},
					{value: 'Sponsorship Climate', label: 'payment_form.gpch_products.sponsorship_climate'},
					{value: 'Sponsorship Fleet', label: 'payment_form.gpch_products.sponsorship_fleet'},
					{value: 'Sponsorship Forest', label: 'payment_form.gpch_products.sponsorship_forest'},
					{value: 'Sponsorship Ocean', label: 'payment_form.gpch_products.sponsorship_ocean'}
				],
			}
		]},
		translations: {
			en: {
				purposes: {
					p1: 'Greenpeace Switzerland'
				},
				payment_form: {
					gpch_product: 'Salesforce Product',
					gpch_products: {
						standard_donation: 'Standard Donation',
						sponsorship_agriculture: 'Sponsorship Agriculture',
						sponsorship_climate: 'Sponsorship Climate',
						sponsorship_fleet: 'Sponsorship Fleet',
						sponsorship_forest: 'Sponsorship Forest',
						sponsorship_ocean: 'Sponsorship Ocean'
					}
				},
				blocks: {
					payment_profile: {
						email_permission_info_html: "<p>I would like Greenpeace Switzerland to inform me by e-mail about ongoing projects.</p>\n"
					}
				}
			},
			de: {
				purposes: {
					p1: 'Greenpeace Schweiz'
				},
				payment_form: {
					gpch_product: 'Salesforce Produkt',
					gpch_products: {
						standard_donation: 'Standard Spende',
						sponsorship_agriculture: 'Patenschaft Landwirtschaft',
						sponsorship_climate: 'Patenschaft Klima',
						sponsorship_fleet: 'Patenschaft Flotte',
						sponsorship_forest: 'Patenschaft Urwälder',
						sponsorship_ocean: 'Patenschaft Meer'
					}
				},
				blocks: {
					payment_profile: {
						email_permission_info_html: "<p>Ich möchte, dass Greenpeace Schweiz mich per E-Mail über laufende Projekte informiert.</p>\n"
					}
				}
			}
		},
		amounts: [
			{
				"if": "paymentType() == onetime",
				"then": [39,84,150,250]
			},
			{
				"if": "paymentType() == recurring && recurringInterval() == monthly",
				"then": [7,10,20,50]
			},
			{
				"if": "paymentType() == recurring && recurringInterval() == quarterly",
				"then": [21,30,60,150]
			},
			{
				"if": "paymentType() == recurring && recurringInterval() == semestral",
				"then": [42,60,120,300]
			},
			{
				"if": "paymentType() == recurring && recurringInterval() == yearly",
				"then": [84,120,240,600]
			}
		],
		minimumCustomAmount: [
			{
				"if": "paymentType() == recurring && recurringInterval() == monthly",
				"then": 2
			},
			{
				"if": "paymentType() == recurring && recurringInterval() == quarterly",
				"then": 6
			},
			{
				"if": "paymentType() == recurring && recurringInterval() == semestral",
				"then": 12
			},
			{
				"if": "paymentType() == recurring && recurringInterval() == yearly",
				"then": 24
			}
		]
	});

	function beforePaymentValidateAndSendHandler(event) {

		var payment_type = window.rnw.tamaro.instance.paymentForm.data.payment_type;

		if (payment_type === 'onetime') {
			window.rnw.tamaro.instance.paymentForm.data.stored_sf_Opportunity_Product__c = window.rnw.tamaro.instance.paymentForm.data.gpch_product;
			window.rnw.tamaro.instance.paymentForm.data.stored_sf_npe03__Recurring_Donation__c_Product__c = '';
		}

		if (payment_type === 'recurring') {
			window.rnw.tamaro.instance.paymentForm.data.stored_sf_npe03__Recurring_Donation__c_Product__c = window.rnw.tamaro.instance.paymentForm.data.gpch_product;
			window.rnw.tamaro.instance.paymentForm.data.stored_sf_Opportunity_Product__c = '';
		}
	}

	window.rnw.tamaro.events.beforePaymentValidateAndSend.subscribe(beforePaymentValidateAndSendHandler);

	function afterRenderHandler(event) {
		console.log('[afterRenderHandler]');
		$(".widget-block.payment-submit-block").hide();
	}
	window.rnw.tamaro.events.afterRender.subscribe(afterRenderHandler);

	$( document ).ready(function() {

		console.log($(".widget-block.payment-submit-block"));

		// $(".widget-block.payment-submit-block").hide();
		// document.querySelector(".widget-block.payment-submit-block").style.display = 'none';
		document.getElementsByClassName("payment-submit-block")[0].style.display = 'none';

		$(".widget-block.footer-info").hide();

		const nextStepButton = $.parseHTML('<div class="widget-block next-step-block"><div class="next-step"><div class="main"><button type="button" class="btn btn-block btn-primary md-ripple" onClick="nextStep()"><span class="btn-text">Next Step</span><div class="md-ripple-cont"></div></button></div></div></div>');
		$(nextStepButton).insertAfter(".widget-block.payment-submit-block");
	});

	function nextStep() {

		$('.next-step-block').hide();

		rnw.tamaro.instance.config.paymentWidgetBlocks = [
			'payment_amounts_and_intervals',
			'payment_payment_methods',
			'payment_profile',
			'payment_address',
			'payment_cover_fee'
		];

		$('.payment-submit-block').show();
		$('.footer-info').show();
	}

</script>

</body>
</html>
